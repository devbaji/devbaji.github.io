import{reactive as e,watch as t,defineComponent as i,useSlots as o,onMounted as n,openBlock as a,createElementBlock as l,normalizeClass as c,unref as d,createCommentVNode as r,renderSlot as p,ref as s}from"vue";var u=Object.freeze({__proto__:null});var g={library:"https://accounts.google.com/gsi/client",defaultButtonConfig:{theme:"outline",size:"large"}};const f=e({clientId:null,popupType:"CODE",prompt:!1,autoLogin:!1,idConfiguration:null,buttonConfig:g.defaultButtonConfig,callback:()=>{}}),m=e({apiLoaded:!1,apiLoadIntitited:!1}),b=e=>{try{const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),i=decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(i)}catch(e){throw"JWT provided is invalid"}},x=new Promise((e=>{if(!m.apiLoadIntitited){const t=document.createElement("script");m.apiLoadIntitited=!0,t.addEventListener("load",(()=>{m.apiLoaded=!0,e(window.google)})),t.src=g.library,t.async=!0,t.defer=!0,document.head.appendChild(t)}})),w=e=>{m.apiLoadIntitited?m.apiLoaded?e(window.google):t((()=>m.apiLoaded),(t=>{t&&e(window.google)})):x.then((t=>{e(t)}))},y=(e,t,i,o)=>{if(!e.client_id)throw new Error("A valid Google API client ID must be provided");w((()=>{((e,t,i,o=!1,n)=>{window.google.accounts.id.initialize(e);const a=document.getElementById(t);a&&!n&&window.google.accounts.id.renderButton(a,i),o&&window.google.accounts.id.prompt()})(e,t,i.buttonConfig,i.prompt,o)}))},I=e=>new Promise(((t,i)=>{w((o=>{if(!e&&!f.clientId)throw new Error("clientId is required since the plugin is not initialized with a Client Id");o.accounts.oauth2.initCodeClient({client_id:e||f.clientId||"",scope:"email profile",ux_mode:"popup",callback:e=>{e.code?t(e):i(e)}}).requestCode()}))})),C=e=>new Promise(((t,i)=>{w((o=>{if(!e&&!f.clientId)throw new Error("clientId is required since the plugin is not initialized with a Client Id");o.accounts.oauth2.initTokenClient({client_id:e||f.clientId||"",scope:"email profile",callback:e=>{e.access_token?t(e):i(e)}}).requestAccessToken()}))})),h=e=>{if(!e&&(e={}),!e.clientId&&!f.clientId)throw new Error("clientId is required");const t={};return e.clientId&&(t.client_id=e.clientId),!e.clientId&&f.clientId&&(t.client_id=f.clientId),e.context&&(t.context=e.context),null!=e.autoLogin&&(t.auto_select=e.autoLogin),null!=e.cancelOnTapOutside&&(t.cancel_on_tap_outside=e.cancelOnTapOutside),new Promise(((i,o)=>{t.callback=t=>{e&&e.callback&&e.callback(t),t.credential?i(t):o(t)},w((i=>{i.accounts.id.initialize(t),i.accounts.id.prompt((t=>{e&&e.onNotification&&e.onNotification(t),t.isNotDisplayed()&&("suppressed_by_user"===t.getNotDisplayedReason()?o("Prompt was suppressed by user'. Refer https://developers.google.com/identity/gsi/web/guides/features#exponential_cooldown for more info"):o(`Prompt was not displayed, reason for not displaying:${t.getNotDisplayedReason()}`)),t.isSkippedMoment()&&o(`Prompt was skipped, reason for skipping: ${t.getSkippedReason()}`)}))}))}))},k=()=>{w((e=>{e.accounts.id.disableAutoSelect()}))};var _=i({props:{clientId:{type:String,required:!1},prompt:{type:Boolean,required:!1,default:!1},autoLogin:{type:Boolean,required:!1,default:!1},popupType:{type:String,required:!1,default:"CODE"},idConfiguration:{type:Object,required:!1},buttonConfig:{type:Object,required:!1},callback:{type:Function,required:!1}},setup(e){const t=e,i=!!o().default,s=((e,t)=>{const i={...e};for(const e in t)void 0!==t[e]&&null!==t[e]&&(i[e]=t[e]);return i})(f,t),u={client_id:s.clientId||null,auto_select:s.autoLogin||!1,callback:s.callback,...s.idConfiguration},g=`g-btn-${"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}`;return n((()=>{y(u,g,s,i)})),(e,t)=>(a(),l("div",{class:c(["g-btn-wrapper",[!d(m).apiLoaded&&"api-loading"]]),onClick:t[0]||(t[0]=e=>d(i)&&void("TOKEN"===d(s).popupType?C(s.clientId).then((e=>{s.callback&&s.callback(e)})):I(s.clientId).then((e=>{s.callback&&s.callback(e)}))))},[d(i)?r("v-if",!0):(a(),l("span",{key:0,id:g,class:"g-btn"})),p(e.$slots,"default")],2))}});!function(e,t){void 0===t&&(t={});var i=t.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===i&&o.firstChild?o.insertBefore(n,o.firstChild):o.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}}("\n.g-btn-wrapper[data-v-5e610566] {\n  display: inline-block;\n}\n.g-btn-wrapper.api-loading[data-v-5e610566] {\n  opacity: 0.5;\n  pointer-events: none;\n}\n"),_.__scopeId="data-v-5e610566",_.__file="src/plugin/GoogleLogin.vue";const v=()=>{const e=s(!1);return t((()=>m.apiLoaded),(t=>{e.value=t})),e};var L={install:(e,t)=>{t&&(e=>{e.clientId&&(f.clientId=e.clientId),e.popupType&&(f.popupType=e.popupType),null!=e.prompt&&(f.prompt=e.prompt),null!=e.autoLogin&&(f.autoLogin=e.autoLogin),e.idConfiguration&&(f.idConfiguration=e.idConfiguration),e.buttonConfig&&(f.buttonConfig=e.buttonConfig),e.callback&&(f.callback=e.callback)})(t),x.then((()=>{t&&(e=>{if(e.clientId){const t={client_id:e.clientId,auto_select:!0===e.autoLogin,callback:e.callback,...e.idConfiguration};window.google.accounts.id.initialize(t),e.prompt&&window.google.accounts.id.prompt()}})(t)})),e.component("GoogleLogin",_)}};export{u as CallbackTypes,_ as GoogleLogin,b as decodeCredential,L as default,I as googleAuthCodeLogin,k as googleLogout,h as googleOneTap,w as googleSdkLoaded,C as googleTokenLogin,v as useGoogleSdkLoaded};
